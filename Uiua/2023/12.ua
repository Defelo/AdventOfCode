&fras ⊢⇌ &args

⊜(⍜(°□⊏1)(⊜⋕≠@,.)⊜□≠@ .)≠@\n.

Take! ← (
  ⊙(⟜⊏⊙,-1)
  /×◡[
    ⊃(≥0◌
    | ≤⊙◌
    | ¬∈⊙@.⬚@?↙¯⊃(⋅⋅∘|↙⊙⋅⋅∘)
    | ⨬(1|≠@#⊏)≥0.-1-⊃(⋅⋅∘|∘))]
  ⨬(0|^0-1-⊃(⋅⋅∘|⟜⋅∘))
)
Skip! ← ⨬(0|^0-1)≠@#◡(⊏-1⊙⋅∘)
Dp ← |4 memo(
  ⨬(=0◌|+⊃Take!Dp Skip!Dp)>0.
)

Solve! ← /+≡(Dp◡∩⧻ ^0 ∩°□°⊟)
⊃Solve!(◌⍜(⊂@?)(♭↯5) ⊙(♭↯5)) Solve!∘
