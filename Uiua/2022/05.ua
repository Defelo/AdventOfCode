&i "lib.ua" "Load"

/⊔⊜□⊂∶0≡/↥◫2≠@\n.
⊜(⊜parse∵(×⊃'≥@0'≤@9).)≠@\n.
⊙(
  ⊜∘≠@\n.
  ⍜⇌'↘1
  ≡(□▽≠@ .)⍉≡(⊏+1×4⇡⌈÷4⧻.)
)
⍜⍉'-0_1_1

M! ← ⍜⊏;⊙∶⊢⇌∶⊙∶□ ⊙(⍜⊏;⊙'∶⊙∶⊏1,□) ⊂^1⊙'∶⊙(⊔⊏⊢⇌,,) ⊃↙↘⊢, ⊔⊏⊏1,,
S! ← &p ≡⊢ ∧1_1'M!^1∶∶
⊃(S!∘)(S!⇌)
