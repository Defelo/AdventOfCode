&fras ⊣ &args

N ← "J|LS"
E ← "L-FS"
S ← "F|7S"
W ← "7-JS"

Step ← ⊏⊙[¯1_0 0_1 1_0 0_¯1]

⊜∘≠@\n.

⟜[⊃(×⊃(∊N|⬚0↻¯1∊S)
  | ×⊃(∊E|⬚0≡↻1∊W)
  | ×⊃(∊S|⬚0↻1∊N)
  | ×⊃(∊W|⬚0≡↻¯1∊E))]
⊢⊚=@S
◡(⊢⊚≡⊡¤)

Next ← ⊢▽:⟜⊏⊙◡(≡⊡¤) ◿4+-1⇡3:+Step⟜:
⊙⋅⋅∘⍢(⊙Next⊂⊙,|¬∊⊙◌)↯0_2[]

A ← ÷2⧻
B ← /+♭×≡\≠ ⊃(=2⍜⊡(+1)|¬⍜⊡(+1)⊙(×0))⊙⊢
⊃B A
