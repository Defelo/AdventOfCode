&fras ⊣ &args

⊜∘⊸≠@\n

°¤⊸path(▽≠@#:⟜⊡⊂⊃+-⋯1_2¤|=@S⊡)⊢⊚⊸=@E

Solve ← (
  ♭₋₁⊞(⊟⟜+)⊸:▽∩♭₋₁≥/+°⍉⌵⟜:⊞⊟.⍜-⇡⊃¯+₁.
  ⊙⊙◌▽◡(≠@#⬚@#⊡⊣⤸1⊙⋅∘)
  °⊟⤸1 ⊙(⍜⊡∵◌⟜⊃(°⊚|⇡⧻))
  /+≥100-+⊃(/+⍉⌵-|∩⊡⊙,)
)

⊃(Solve20|Solve2)
