&fras ⊣ &args

⊜⊜□⊸∩≠@\n,@-
°⊚⊂⟜≡⇌⍜♭⊃⊛◴

BK ← |4 (
  ⊚×¬⊏⊙:⊙◡⋅⋅⊙⋅∘⬚0⊢⊚◡⋅⋅↥⊸↯¬/↥◡⋅↥
  ⊙⋅⋅⋅◌∧(
    ⊂⊙◡(BK ⊃(⍜⊏⋅1|∩×⟜:⊏⊙⋅◡⋅⋅∘)):
    ⊙⊙⍜(⊏⊙≡⊟)⋅0_1⊙:
  )
)

A ← (
  ◴≡⍆/◇⊂⍚(↯∞_3≡⊂¤⊙(⊚/×)⟜⊏) ⊙¤◴≡⍆⊸⊚
  /+/↥⍉⊏⊙(=@t≡◇⊢)
)

B ← /$"_,_"⍆▽°¤▽=⊸/↥/+⊸⍉BK,⊸+1↯⊙0⧻.

∩&p ⊃B A
