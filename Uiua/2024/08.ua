&fras ⊣ &args

⊜∘≠@\n.

Valid ← /××∩>¯1.
Walk  ← ⊙⋅⋅◌⍢(⊃(⊂⊙◌|⋅⟜+)|⋅⋅Valid)↯0.⊸-

≡(□⧅<2⊚=)⊙¤▽⊸≠@.◴⊸♭⟜(¤¤△)

A ← ⍚≡(□▽:⟜≡Valid⊟∩(+⊸-)◡:°⊟)
B ← ⍚≡(□⊂∩Walk ◡(:⊙⊙∘)°⊟)

∩(⧻◴/◇⊂⍚/◇⊂) ⊃B A
